#!/usr/bin/env bash

set -euo pipefail

python=python3
N=200

for pkg in $*
do
    outfile=$(basename $pkg)
    eggpath="$(pwd)/${pkg}"
    pklfile=${outfile/egg/pkl}
    echo "Running benchmarks with $eggpath"
    PYTHONPATH="$eggpath" $python append/append.py $N results/append-$pklfile
    PYTHONPATH="$eggpath" $python large-da/large-da.py $N results/lda-$pklfile
done

./append/append $N > results/append-times.txt
./large-da/lda $N > results/lda-times.txt

$python plotresults.py
